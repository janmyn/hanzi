<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>01</title>
    <link rel="stylesheet" href="//at.alicdn.com/t/c/font_5046375_njawe1hwe8.css">
    <style>
        /* è‡ªå®šä¹‰å­—ä½“ï¼šæ¥·ä½“ - ç¡®ä¿æ‰€æœ‰è®¾å¤‡éƒ½èƒ½åŠ è½½ */
        @font-face {
            font-family: 'CustomKaiTi';
            src: url('fonts/FangZhengKaiTiJianTi/KaiTi.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap; /* ä¼˜åŒ–å­—ä½“åŠ è½½ä½“éªŒ */
        }

        /* è‡ªå®šä¹‰å­—ä½“ï¼šRoboto */
        @font-face {
            font-family: 'CustomRoboto';
            src: url('fonts/Roboto/Roboto.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        * {
            margin: 0px;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'CustomRoboto', 'Roboto', 'Didot', 'Futura', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: #2d2d42;
            min-height: 100vh;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        /* æ±‰å­—ä½¿ç”¨æ¥·ä½“ - ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ */
        .hanzi, #hanzi-display, .question, .option, .phone-display, .pinyin, .meaning {
            font-family: 'CustomKaiTi', 'KaiTi', 'æ¥·ä½“', 'STKaiti', 'åæ–‡æ¥·ä½“', serif !important;
        }

        .title {
            font-size: 2.2em;
            color: #585858ae;
            /* é¦–é¡µæ ‡é¢˜é—´è· */ 
            margin-bottom: 40px;
            font-weight: 700px;
            text-align: center;
        }
        
        .review-title {
            font-size: 1.5em;      /* æŠŠå®ƒæ”¹å°ä¸€ç‚¹ */
            color: #585858ae;     /* æŠŠå®ƒæ”¹æˆè“è‰² */
            margin-bottom: 20px; /* å‡å°ä¸‹æ–¹çš„é—´è· */
            text-align: center;  /* ã€å…³é”®ã€‘è®©å®ƒå±…ä¸­ï¼Œè€Œä¸æ˜¯åƒä¸»æ ‡é¢˜ä¸€æ ·å·¦å¯¹é½ */
}

        .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 40px;
        }
        /*é¦–é¡µçš„çš„ä¸¤ä¸ªæ¿å—reviewå’Œpractice*/
        .modules {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            margin-bottom: 30px;
            /* é¦–é¡µæ¨¡å—æ•´ä½“ä¸Šç§» 10px */
            margin-top: -10px;
        }

        .module {
            background: linear-gradient(135deg, #d9acd8, #97679a);
            color: rgba(246, 246, 240, 0.972);
            padding: 30px 100px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
        }

        .module:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .module h3 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        .module p {
            font-size: 1.1em;
            opacity: 0.7;
        }

        .practice-module {
            background: linear-gradient(135deg, #86c2c2, #69c4ef);
        }

        .hidden {
            display: none !important; /* ä¿è¯å®Œå…¨éšè— */
        }
        

        /* å¤ä¹ æ¨¡å—æ ·å¼ */
        /* å°±æ˜¯å°±æ˜¯é‚£ä¸ªç™½è‰²çš„ã€å¸¦åœ†è§’å’Œé˜´å½±çš„â€œç”»æ¡†â€ã€‚*/
        .review-container {
            text-align: center;
            background: rgb(255, 253, 253, 1);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0);
            padding: 20px;
            max-width: 800px;
            width: 100%;
            /* 1. å¼€å¯ç›¸å¯¹å®šä½ */
            position: relative;
        /* 2. ç›¸å¯¹äºå®ƒçš„åº•éƒ¨ï¼Œå‘ä¸Šæ¨20px */
            bottom: 20px; /* é¦–é¡µ Review å¡ç‰‡ä¸Šç§» 10px */
        }

        .flashcard {
            width: 400px;
            height: 300px;
            margin: 60px auto;
            perspective: 1000px;
            position: relative; /* ä¾¿äºå°†é¦–é¡µæŒ‰é’®å›ºå®šåœ¨ç™½è‰²æ¡†å†… */
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4em;
            font-weight: bold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1), 0 4px 10px rgba(0,0,0,0.2);
        }

        .card-front {
            background: linear-gradient(120deg, #f7f7ed, #f7f7ed);
            color: #282d5e;
        }

        .card-back {
            background: linear-gradient(180deg, #f6f7f2, #f5f6f2);
            color: #282d5e;
            transform: rotateY(180deg);
            flex-direction: column;
        
        }

        .pinyin {
            font-size: 0.7em;
            margin-bottom: 15px;
        }

        .meaning {
            font-size: 0.4em;
            opacity: 0.9;
        }

        .navigation {
            margin-top: 30px;
        }

        .nav-btn {
            background: #595062;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            font-family: 'Roboto', sans-serif;
        }

        .nav-btn:hover {
            background: #fcb662;
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* ç»ƒä¹ æ¨¡å—æ ·å¼ */
        .practice-container {
            text-align: center;
            position: relative; /* ä¾¿äºæ”¾ç½®å·¦ä¸Šè§’è¿”å›æŒ‰é’® */
        }
        .practice-header {
            display: inline-flex;
            align-items: center;
            gap: 40px; /* é»˜è®¤ï¼šå°å±æˆ–æ— åª’ä½“è¦†ç›–æ—¶å¹¶æ’ */
        }
        /* é‡ç½®åœ¨æ ‡é¢˜è¡Œå†…çš„ Home æŒ‰é’®ä¸ºéç»å¯¹å®šä½ */
        #practice-page .practice-header .back-home-btn {
            position: static;
            margin: 0;
            
        }
        /* æ¡Œé¢ç«¯ï¼šPractice å±…ä¸­æ˜¾ç¤ºï¼›Home åŒè¡Œä¸”è·å®¹å™¨å·¦ä¾§40px */
        @media (min-width: 769px) {
            #practice-page .practice-container { padding-top: 20px; }
            #practice-page .practice-header {
                display: grid;
                grid-template-columns: 1fr auto 1fr; /* å·¦ç©º-ä¸­æ ‡é¢˜-å³ç©º */
                align-items: center;
            }
            #practice-page .practice-header .back-home-btn {
                position: static; /* éå›ºå®š */
                justify-self: start;
                margin-left: 40px; /* è·å®¹å™¨å·¦ä¾§40px */
            }
            #practice-page .practice-header .title {
                justify-self: center; /* å±…ä¸­ */
                margin: 0;
            }
        }

        .practice-nav {
            display: none; /* ä¸å†ä½¿ç”¨ */
        }

        .practice-tab {
            display: none; /* ä¸å†ä½¿ç”¨ */
        }

        .practice-tab.active { display: none; }
        .practice-tab.locked { display: none; }

        /* ç»ƒä¹ ä¸­å¿ƒç¾åŒ– */
        .practice-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* ä¸Šé¢1ã€2ï¼›ä¸‹é¢3ã€4 */
            gap: 25px;
            /* ç»ƒä¹ ä¸­å¿ƒæ ‡é¢˜ practice å‘ä¸Šç§»åŠ¨ */ 
            margin: 50px 0 20px;
        }
        .practice-card {
            position: relative;
            padding: 20px;
            border: 2px solid #282d5e;
            background: #f0e9de;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            box-shadow: 0 6px 16px rgba(0,0,0,0.06);
        }
        .practice-card:hover {
            transform: translateY(-2px);
            border-color: #4ecdc4;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .practice-card.locked {
            cursor: not-allowed;
            opacity: 0.6;
        }
        .practice-card.locked::after {
            content: 'ğŸ”’';
            position: absolute;
            top: 10px;
            right: 12px;
            font-size: 18px;
        }
        .practice-card .card-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }
        .practice-card h4 {
            font-size: 1.1em;
            margin-bottom: 6px;
            color: #2d2d42;
        }
        .practice-card p {
            font-size: 0.9em;
            color: #2d2d42;
        }

        .back-home-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 8px 14px;
            border-radius: 18px;
            border: none;
            background: #5d7399;
            color: #fff;
            cursor: pointer;
            font-size: 0.9em;
            z-index: 10; /* ç¡®ä¿æŒ‰é’®åœ¨æœ€ä¸Šå±‚ */
            font-family: 'Roboto', sans-serif;
        }
        /* ç»ƒä¹ é¡µï¼šæ¡Œé¢ç«¯é»˜è®¤è·å·¦ 40px */
        #practice-page .back-home-btn { left: 40px; }
        
        .back-home-btn:hover { background: #5a6fd8; }

        .practice-content {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* æ‰“å­—ç»ƒä¹ è¾“å…¥æ¡†æ ·å¼ */
        .typing-input {
            width: 260px;
            padding: 14px 16px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1.2em;
            text-align: center;
            outline: none;
            transition: all 0.2s ease;
            font-family: 'CustomKaiTi', 'KaiTi', 'æ¥·ä½“', 'STKaiti', 'åæ–‡æ¥·ä½“', serif;
        }
        .typing-input:focus { border-color: #4ecdc4; box-shadow: 0 0 0 4px rgba(78,205,196,0.15); }
        .typing-input.correct { border-color: #feffe4; background: #f0fff2; }
        .typing-input.incorrect { border-color: #f44336; background: #fff5f4; }

        .question {
            font-size: 4em;
            margin: 30px 0 60px 0;
            color: #fffcfc;
            font-weight: bold;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 500px;
            width: 100%;
        }

        .option {
            background: white;
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5em;
            font-weight: bold;
        }

        .option:hover {
            border-color: #4ecdc4;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .option.correct {
            background: #279265;
            color: white;
            border-color: #4CAF50;
        }

        .option.incorrect {
            background: #312625;
            color: white;
            border-color: #81312b;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
            transition: width 0.3s ease;
        }

        .score-display {
            font-size: 1.2em;
            margin: 20px 0;
            color: #666;
        }

        .next-btn {
            background: #595062;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 80px;
            transition: all 0.3s ease;
            font-family: 'Roboto', sans-serif;
        }

        /* ç»ƒä¹ 3ï¼šSubmit/Next é—´è·ä¼˜åŒ– */
        .practice-content.practice-3 #typing-submit { margin-top: 20px; }
        .practice-content.practice-3 #next-practice-btn { margin-top: 20px; }

        .next-btn:hover {
            background: #fcb662;
            transform: translateY(-2px);
        }

        .next-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .summary-container {
            text-align: center;
            padding: 20px;
        }

        .summary-title {
            font-size: 2.5em;
            color: #00B4D8;
            margin-bottom: 30px;
        }

        #summary-text {
            color: #f5f5dc;
            font-size: 1em;
            margin-bottom: 30px;
            white-space: pre-line;
        }

        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(#e6cb1b 0deg, #edd711 var(--score-angle), #eee var(--score-angle));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px auto;
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            background: white;
            border-radius: 50%;
        }

        .score-text {
            position: relative;
            z-index: 1;
            font-size: 2em;
            font-weight: bold;
            color: #242420;
        }

        .back-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            margin-top: 30px;
            transition: all 0.3s ease;
            font-family: 'Roboto', sans-serif;
        }

        .back-btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        /* åˆ†æ•°é¡µæŒ‰é’®è¡Œå¸ƒå±€ */
        .summary-actions {
            display: flex;
            justify-content: center;
            /* score å’Œ details ä¸­é—´çš„é—´è· */
            gap: 17px;
            margin-top: 10px;
        }

        /* è¯¦æƒ…é¡µé¢ */
        .detail-container {
            max-width: 1000px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 0px;
            padding: 5px;
        }
        .detail-title {
            font-size: 2.2em;
            color: #2d2d42;
            margin-bottom: 16px;
            text-align: center;
            font-family: 'Roboto', 'Didot', 'Futura', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        .detail-section-title {
            margin-top: 18px;
            margin-bottom: 15px;
            color: #2d2d42;
            font-weight: bold;
            font-family: 'Roboto', 'Didot', 'Futura', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        /* è¯¦æƒ…é¡µï¼šæ¯ä¸ªç»ƒä¹ è¡¨æ ¼å—ä¹‹é—´å¢åŠ é—´è· */
        #detail-page .detail-section {
            margin-bottom: 40px;
        }
        #detail-page .detail-section:last-child {
            margin-bottom: 0;
        }
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            background: #fafafa;
            border-radius: 8px;
            overflow: hidden;
        }
        /* è¯¦æƒ…é¡µè¡¨æ ¼ä¸­æ–‡å­—ä½“ä½¿ç”¨æ¥·ä½“ï¼Œè‹±æ–‡/æ•°å­—ç”¨ .latin æŒ‡å®š */
        #detail-page .detail-table,
        #detail-page .detail-table td {
            font-family: 'CustomKaiTi', 'KaiTi', 'æ¥·ä½“', 'STKaiti', 'åæ–‡æ¥·ä½“', serif;
        }
        /* è¡¨å¤´ä¸ºè‹±æ–‡ï¼Œé‡‡ç”¨ Roboto */
        #detail-page .detail-table th { font-family: 'CustomRoboto', 'Roboto', 'Helvetica Neue', Arial, sans-serif; }
        /* è‹±æ–‡ä¸æ•°å­—ä¸“ç”¨å­—ä½“ */
        #detail-page .latin { font-family: 'CustomRoboto', 'Roboto', 'Helvetica Neue', Arial, sans-serif; }
        .detail-table th, .detail-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
            text-align: center; /* Webç‰ˆå…¨éƒ¨å±…ä¸­ */
            color: #2d2d42;
        }
        /* è¡¨æ ¼é¢œè‰² */ 
        .detail-table th {
            background:#595062;
            color: #ffffff;
        }
        /* é”™è¯¯ç­”æ¡ˆæ ‡çº¢ï¼ˆæé«˜é€‰æ‹©å™¨ä¼˜å…ˆçº§ï¼Œè¦†ç›–å•å…ƒæ ¼é»˜è®¤é¢œè‰²ï¼‰ */
        .detail-table td.tag-correct { color: #2e7d32; }
        .detail-table td.tag-wrong { color: #c62828; }

        /* æ‰‹æœºå·ç»ƒä¹ ç‰¹æ®Šæ ·å¼ */
        .phone-display {
            font-size: 2.5em;
            font-family: 'Courier New', monospace;
            letter-spacing: 0.1em;
            margin: 20px 0;
            color: #333;
        }

        /* éŸ³é¢‘æ’­æ”¾æŒ‰é’® */
        .audio-btn {
       
        /* 1. ä½¿ç”¨ç»å¯¹å®šä½ */
            position: absolute; /* è®©æŒ‰é’®å¯ä»¥ç›¸å¯¹äºçˆ¶å®¹å™¨è‡ªç”±ç§»åŠ¨ */
            top:100%;
            left:50%;
            bottom: 80px;       /* è·ç¦»åº•éƒ¨ 15px */
            right: 50%;        /* è·ç¦»å³è¾¹ 15px */

        /* 2. å˜æˆä¸€ä¸ªåœ†å½¢å°æŒ‰é’® */
            width: 50px;
            height: 50px;
            border-radius: 50%; /* 50% = æ­£åœ†å½¢ */
            padding: 0;         /* ç§»é™¤å†…è¾¹è· */
        /* 3. ç¾åŒ– */
            background:transparent;
            color: rgb(241, 231, 231,);
            border: none;
            padding: 15px 30px;
            border-radius: 0%;
            cursor: pointer;
            font-size: 0.3em;
            transition: all 0.3s ease;
            font-family: 'Roboto', sans-serif; 
        /* 4. (æ–°å¢) ç¡®ä¿å›¾æ ‡å®Œç¾å±…ä¸­ */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .audio-btn:hover {
            background:transparent;
            transform: translateY(-2px);
        }

        /* å¤ä¹ é—ªå¡å†…çš„éŸ³é¢‘æŒ‰é’®æ”¾åœ¨æ‹¼éŸ³ä¸è‹±æ–‡ä¸‹é¢ï¼Œæ”¹ä¸ºå¸¸è§„æŒ‰é’®å¸ƒå±€ */
        .card-face .audio-btn {
            position: static;
            top: auto;
            left: auto;
            right: auto;
            bottom: auto;
            width: auto;
            height: auto;
            border-radius: 25px;
            padding: 8px 16px;
            margin-top: 10px;
            background: transparent;
            color: rgb(203, 172, 172);
        }
        
        /* ç»ƒä¹ 4éŸ³é¢‘æŒ‰é’® - å¼ºåˆ¶è¦†ç›–ç»å¯¹å®šä½ï¼Œåªåœ¨ç»ƒä¹ 4æ˜¾ç¤º */
        #audio-question-btn {
            position: static !important;
            top: auto !important;
            left: auto !important;
            bottom: auto !important;
            right: auto !important;
            width: 80px !important;
            height: 80px !important;
            border-radius: 50% !important;
            background: rgba(255, 255, 255, 0.1) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            font-size: 2em !important;
            margin: 20px auto !important;
            display: block !important;
            color: rgb(203, 172, 172) !important;
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif !important;
            line-height: 1 !important;
            padding: 0 !important;
        }
        
        
        
        /* ç¡®ä¿éŸ³é¢‘æŒ‰é’®åªåœ¨ç»ƒä¹ 4æ˜¾ç¤ºï¼Œå…¶ä»–ç»ƒä¹ éšè— */
        .practice-content:not(.practice-4) #audio-question-btn {
            display: none !important;
        }

        @media (max-width: 768px) {
            /* ä¸»é¡µå®¹å™¨æ ·å¼ - å¼ºåˆ¶è¦†ç›– */
            #main-page {
                width: 78% !important;
                max-width: none !important;
                box-sizing: border-box;
                padding: 5px;
                margin: 10px;
            }
            
            /* é—ªå¡é¡µé¢å®¹å™¨æ ·å¼ - å¼ºåˆ¶è¦†ç›– */
            #review-page {
                width: 95% !important;
                max-width: none !important;
                min-height: 600px;
                padding: 5px;
                margin: 10px;
                padding-top: 40px;
            }
            
            /* ç»ƒä¹ é¡µé¢å®¹å™¨æ ·å¼ */
            #practice-page {
                width: 95% !important;
                max-width: none !important;
                padding: 5px;
                margin: 10px;
            }
            .modules, .practice-grid, .options {
                grid-template-columns: 1fr; /* å…³é”®ï¼šæ‰€æœ‰ç½‘æ ¼å¸ƒå±€éƒ½å˜æˆå•åˆ— */
            }
            /*ç»ƒä¹ 1å››ä¸ªç­”æ¡ˆé€‰é¡¹*/ 
            .options {
                grid-template-columns: repeat(2, 1fr);
                margin-top: -5px;
            }
            /* h2 æ ‡é¢˜ä½ç½®*/ 
            .question {
                font-size: 4em;
                margin-top: -40px;
            }
            
            .flashcard {
                width: 95%;
                height: 350px;
                margin: 10px auto;
            }
            .review-container {
                padding: 15px;
                bottom: 10px;
                position: relative;
            }
            
            .card-face {
                font-size: 0.8em;
                padding: 15px;
            }
            
            .card-face h2 {
                font-size: 2em;
                margin-bottom: 8px;
            }
            
            .card-face .pinyin {
                font-size: 1em;
                margin-bottom: 6px;
            }
            
            .card-face .meaning {
                font-size: 0.9em;
                margin-bottom: 6px;
            }
            /* ç§»åŠ¨ç«¯ç»ƒä¹ ä¸­å¿ƒæ”¹ä¸ºå•åˆ— */
            .practice-grid { grid-template-columns: 1fr; }
            
            /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
            /* HTML ä¸­ä»»ä½•å¸¦æœ‰ class="title" çš„æ ‡é¢˜å…ƒç´ ã€‚*/
            .title {
                font-size: 2.0em;
                margin-bottom: 30px;
            }
            .summary-title { font-size: 2.0em; }
            .detail-title { font-size: 1.8em; }
            /*HTML ä¸­ä»»ä½•å¸¦æœ‰ class="subtitle" çš„å…ƒç´ */
            .subtitle {
                font-size: 1em;
                margin-bottom: 5px;
            }
            
            .module {
                padding: 60px 20px; 
                /*adding: 60px 20px;: è®¾ç½®æŒ‰é’®çš„å†…è¾¹è·ã€‚æŒ‰é’®å†…éƒ¨æ–‡å­—çš„ä¸Šæ–¹å’Œä¸‹æ–¹ï¼Œå„å¢åŠ  60px çš„ç©ºç™½ç©ºé—´ã€‚åœ¨æ–‡å­—çš„å·¦æ–¹å’Œå³æ–¹ï¼Œå„å¢åŠ  20px çš„ç©ºç™½ç©ºé—´ã€‚*/
                margin-bottom: 5px;
                /*è®¾ç½®æŒ‰é’®çš„ä¸‹å¤–è¾¹è·*/
                min-height: 100px;
            }
            /*ä¸¤ä¸ªæ¨¡å—ä¹‹é—´çš„è·ç¦»*/
            .module:nth-child(2) {
                margin-top: -35px;
            }
            
            .module h3 {
                font-size: 2.2em;
            }
            
            .module p {
                font-size: 1.1em;
            }
            
            .practice-card {
                padding: 25px;
                margin-bottom: 5px;
                min-height: 100px;
            }
            
            .practice-card h4 {
                font-size: 1.2em;
            }
            
            .practice-card p {
                font-size: 1em;
            }
            
            .back-home-btn {
                top: 3px;
                left: 5px;
                padding: 6px 12px;
                font-size: 0.8em;
            }
            /* ç§»åŠ¨ç«¯ï¼šä¿æŒç°æœ‰å¸ƒå±€ï¼ŒHome å•ç‹¬å·¦ä¸Šè§’ */
            #practice-page .practice-header { display: block; }
            #practice-page .practice-header .back-home-btn { position: absolute; left: 20px; top: 10px; }
            #practice-page .practice-header .title { display: block; }
            
            .nav-btn {
                padding: 6px 12px;
                font-size: 0.8em;
                margin: 0 5px;
            }
            
            .audio-btn {
                padding: 8px 16px;
                font-size: 0.8em;
                margin: -10px 0 10px 0;
                width:50px;
                height:20px;

            }
            /*ç»ƒä¹ 4 éŸ³é¢‘å›¾æ ‡*è¾¹è·*/
            #audio-question-btn {
                margin-top: 5px;
                margin-bottom: 40px;
            }
            /*æ‰‹æœºç«¯nextæŒ‰é’®*/
            .next-btn {
                padding: 12px 24px;
                font-size: 1em;
                margin-top: 35px;
            }
            
            .typing-input {
                width: 200px;
                padding: 12px 14px;
                font-size: 1.1em;
            }
            
            .phone-display {
                font-size: 2em;
                margin: 15px 0;
            }
            
            .card-face {
                font-size: 3em;
            }
            
            .pinyin {
                font-size: 0.35em;
            }
            
            .meaning {
                font-size: 0.25em;
            }
            
            .score-circle {
                width: 150px;
                height: 150px;
            }
            
            .score-circle::before {
                width: 110px;
                height: 110px;
            }
            
            .score-text {
                font-size: 1.5em;
            }
            
            /* ç§»åŠ¨ç«¯ï¼šè¯¦æƒ…é¡µå®¹å™¨å æ»¡æ•´ä¸ªå±å¹•ï¼Œä¸ç•™èƒŒæ™¯ */
            body:has(#detail-page:not(.hidden)) {
                padding: 0;
                margin: 0;
                display: block;
                align-items: stretch;
            }
            #detail-page {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                overflow-y: auto;
                background: #ffffff;
            }
            #detail-page .detail-container {
                width: 100%;
                max-width: 100%;
                min-height: 100vh;
                padding: 10px;
                box-sizing: border-box;
                margin: 0;
                border-radius: 0;
            }
            #detail-page .detail-table {
                width: 100%;
            }
        }
    </style>
</head>
<body>
        <!-- ä¸»é¡µé¢ -->
        <div id="main-page" class="main-container">
            <h1 class="title">01 NUMBERS</h1>            
            <div class="modules">
                <a href="#" class="module" onclick="showReview()">
                    <h3>Review </h3>
                    <p>Flashcards<br>Click to flip for details</p>
                </a>
                
                <a href="#" class="module practice-module" onclick="showPractice()">
                    <h3>Practice</h3>
                    <p>Four Exercises <br>Unlock them step-by-step</p>
                </a>
            </div>
        </div>

        <!-- å¤ä¹ æ¨¡å— -->
        <div id="review-page" class="hidden">
            <div class="review-page-container">
                <div class="review-container">
                <button class="back-home-btn" onclick="showMain()">Home</button>
                <h2 class="title review-title">Review</h2>
                <div class="flashcard">
                    <div class="card" id="flashcard" onclick="flipCard()">
                        <div class="card-face card-front">
                            <span id="hanzi-display">ä¸€</span>
                        </div>
                        <div class="card-face card-back">
                            <div class="pinyin" id="pinyin-display">yÄ«</div>
                            <div class="meaning" id="meaning-display">one</div>
                            <button class="audio-btn" onclick="playReviewAudio(event)">ğŸ”Š</button>
                        </div>
                    </div>
                </div>
               
                <audio id="review-audio" preload="auto"></audio>
                
                <div class="navigation">
                    <button class="nav-btn" id="prev-btn" onclick="prevCard()">Prev</button>
                    <span id="card-counter">1 / 10</span>
                    <button class="nav-btn" id="next-btn" onclick="nextCard()">Next</button>
                </div>
                
                 
            </div>
            </div>
        </div>

        <!-- ç»ƒä¹ æ¨¡å— -->
        <div id="practice-page" class="hidden">
            <div class="practice-container">
                <div class="practice-header">
                    <button class="back-home-btn" onclick="showMain()">Home</button>
                    <h2 class="title">Practice</h2>
                </div>
                <!-- ç»ƒä¹ ä¸­å¿ƒï¼šé€‰æ‹©è¦å¼€å§‹çš„ç»ƒä¹  -->
                <div id="practice-hub">
                    <div class="practice-grid">
                        <div class="practice-card" id="start-0" onclick="startPractice(0)">
                            <div class="card-icon">âŠ</div>
                            <p>Select the character for the number</p>
                        </div>
                        <div class="practice-card locked" id="start-1" onclick="startPractice(1)">
                            <div class="card-icon">â‹</div>
                            <p>Choose the correct pinyin for the Hanzi</p>
                        </div>
                        <div class="practice-card locked" id="start-2" onclick="startPractice(2)">
                            <div class="card-icon">âŒ</div>
                            <p>Type the character for the number</p>
                        </div>
                        <div class="practice-card locked" id="start-3" onclick="startPractice(3)">
                            <div class="card-icon">â</div>
                            <p>Listen and select the character you hear</p>
                        </div>
                    </div>
                </div>

                <!-- å•é¢˜é¡µé¢ï¼šåªæ˜¾ç¤ºä¸€é“é¢˜åŠå››ä¸ªé€‰é¡¹ -->
                <div id="question-page" class="practice-content hidden">
                    <div class="question" id="question-text"></div>
                    <div class="phone-display hidden" id="phone-display"></div>
                    <button class="audio-btn hidden" id="audio-question-btn" onclick="playAudioQuestion()">ğŸ”Š</button>
                    <input class="typing-input hidden" id="typing-input" placeholder="è¯·åœ¨æ­¤å¤„è¾“å…¥" />
                    <button class="next-btn hidden" id="typing-submit" onclick="submitTyping()">Summit</button>
                    <div class="options" id="options-box">
                        <div class="option"></div>
                        <div class="option"></div>
                        <div class="option"></div>
                        <div class="option"></div>
                    </div>
                    <button class="next-btn" id="next-practice-btn" onclick="nextPractice()" disabled>Next</button>
                </div>
            </div>
        </div>

        <!-- æ€»ç»“é¡µé¢ -->
        <div id="summary-page" class="hidden">
            <div class="summary-container">
                <h2 class="summary-title">Good Job!</h2>
                <div class="score-circle" id="score-circle">
                    <div class="score-text" id="final-score">0%</div>
                </div>
                <p id="summary-text">Congratulations! You have completed all the exercises></p>
                <div class="summary-actions">
                    <button class="back-btn" onclick="showSummary()">ğŸ† Score</button>
                    <button class="back-btn" onclick="showDetail()">ğŸ“‹ Details</button>
                </div>
                <button class="back-btn" onclick="showMain()">Home</button>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…é¡µé¢ -->
    <div id="detail-page" class="hidden">
        <div class="detail-container">
            <button class="back-home-btn" onclick="showSummaryFromDetail()">Back</button>
            <h2 class="detail-title">Details</h2>
            <div id="detail-content"></div>
        </div>
    </div>

    <script>
        // æ±‰å­—æ•°æ®
        const hanziData = [
            { hanzi: 'ä¸€', pinyin: 'yÄ«', meaning: 'one' },
            { hanzi: 'äºŒ', pinyin: 'Ã¨r', meaning: 'two' },
            { hanzi: 'ä¸‰', pinyin: 'sÄn', meaning: 'three' },
            { hanzi: 'å››', pinyin: 'sÃ¬', meaning: 'four' },
            { hanzi: 'äº”', pinyin: 'wÇ”', meaning: 'five' },
            { hanzi: 'å…­', pinyin: 'liÃ¹', meaning: 'six' },
            { hanzi: 'ä¸ƒ', pinyin: 'qÄ«', meaning: 'seven' },
            { hanzi: 'å…«', pinyin: 'bÄ', meaning: 'eight' },
            { hanzi: 'ä¹', pinyin: 'jiÇ”', meaning: 'nine' },
            { hanzi: 'å', pinyin: 'shÃ­', meaning: 'ten' }
        ];

        // å…¨å±€å˜é‡
        let currentCardIndex = 0;
        let currentPractice = 0;
        let practiceScores = [0, 0, 0, 0]; // æ¯ä¸ªç»ƒä¹ çš„å¾—åˆ†
        let practiceQuestions = [0, 0, 0, 0]; // æ¯ä¸ªç»ƒä¹ çš„é¢˜ç›®æ•°
        let currentQuestion = 0;
        let isAnswered = false;
        let currentAudioHanzi = null; // å•é¢˜éŸ³é¢‘é¢˜å½“å‰æ­£ç¡®æ±‰å­—
        let currentTypingAnswer = '';
        let currentQuestionMeta = null; // è®°å½•å½“å‰é¢˜å…ƒä¿¡æ¯
        let practiceDetails = [[], [], [], []]; // è®°å½•æ¯ä¸ªç»ƒä¹ çš„é¢˜ç›®è¯¦æƒ…

        // é¡µé¢åˆ‡æ¢å‡½æ•°
        function showMain() {
            document.getElementById('main-page').classList.remove('hidden');
            document.getElementById('review-page').classList.add('hidden');
            document.getElementById('practice-page').classList.add('hidden');
            document.getElementById('summary-page').classList.add('hidden');
            document.getElementById('detail-page').classList.add('hidden');
        }

        function showReview() {
            document.getElementById('main-page').classList.add('hidden');
            document.getElementById('review-page').classList.remove('hidden');
            currentCardIndex = 0;
            updateCard();
        }

        function showPractice() {
            document.getElementById('main-page').classList.add('hidden');
            document.getElementById('practice-page').classList.remove('hidden');
            // å±•ç¤ºç»ƒä¹ ä¸­å¿ƒ
            document.getElementById('practice-hub').classList.remove('hidden');
            document.getElementById('question-page').classList.add('hidden');
            updateHubLocks();
        }

        // å¤ä¹ æ¨¡å—å‡½æ•°
        function updateCard() {
            const data = hanziData[currentCardIndex];
            document.getElementById('hanzi-display').textContent = data.hanzi;
            document.getElementById('pinyin-display').textContent = data.pinyin;
            document.getElementById('meaning-display').textContent = data.meaning;
            document.getElementById('card-counter').textContent = `${currentCardIndex + 1} / 10`;
            
            // é‡ç½®å¡ç‰‡çŠ¶æ€
            document.getElementById('flashcard').classList.remove('flipped');
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('prev-btn').disabled = currentCardIndex === 0;
            document.getElementById('next-btn').disabled = currentCardIndex === 9;

            // åŒæ­¥æ›´æ–°éŸ³é¢‘èµ„æº
            const reviewAudio = document.getElementById('review-audio');
            if (reviewAudio) {
                reviewAudio.src = getAudioSrcForHanzi(data.hanzi);
                // é¢„åŠ è½½ï¼Œå¤±è´¥æ—¶ä¸ä¼šæ‰“æ–­æµç¨‹
                try { reviewAudio.load(); } catch (e) {}
            }
        }

        function flipCard() {
            document.getElementById('flashcard').classList.toggle('flipped');
        }

        function prevCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateCard();
            }
        }

        function nextCard() {
            if (currentCardIndex < 9) {
                currentCardIndex++;
                updateCard();
            }
        }

        // ç»ƒä¹ ä¸­å¿ƒï¼šå¸¦è§£é”é€»è¾‘
        let sessionTargets = []; // æœ¬æ¬¡ç»ƒä¹ çš„é¢˜ç›®ç›®æ ‡é›†ï¼ˆç”¨äºä¸é‡å¤ï¼‰
        const practiceCompleted = [false, false, false, false];
        function updateHubLocks() {
            for (let i = 1; i < 4; i++) {
                const card = document.getElementById(`start-${i}`);
                const locked = !practiceCompleted[i - 1];
                card.classList.toggle('locked', locked);
            }
        }

        function startPractice(index) {
            // è‹¥æœªè§£é”åˆ™ä¸å“åº”
            // è§£é”é™åˆ¶ï¼šé™¤ç»ƒä¹ 1å¤–ï¼Œå¿…é¡»å‰ä¸€é¡¹å®Œæˆ
            if (index > 0 && !practiceCompleted[index - 1]) return;

            currentPractice = index;
            currentQuestion = 0;
            practiceScores[index] = 0;
            practiceQuestions[index] = 0;
            practiceDetails[index] = [];
            isAnswered = false;

            // å‡†å¤‡é¢˜ç›®æ± 
            if (index === 0) {
                sessionTargets = shuffleArray([4,5,6,7,8,9,10]).slice(0,4); // ç»ƒä¹ 1ï¼šæ•°å­—4~10
            } else if (index === 1) {
                // ç»ƒä¹ 2ï¼šéšæœº4ä¸ªæ±‰å­—
                sessionTargets = shuffleArray([...hanziData]).slice(0,4);
            } else if (index === 2) {
                // ç»ƒä¹ 3ï¼šéšæœºç”Ÿæˆ4ä¸ª1-99çš„æ•°å­—ï¼ˆæ’é™¤0ï¼‰
                sessionTargets = shuffleArray(Array.from({length: 99}, (_, i) => i + 1)).slice(0, 4);
            } else if (index === 3) {
                // ç»ƒä¹ 4ï¼šéšæœº4ä¸ªæ±‰å­—ç”¨äºéŸ³é¢‘
                sessionTargets = shuffleArray([...hanziData]).slice(0,4);
            }

            document.getElementById('practice-hub').classList.add('hidden');
            document.getElementById('question-page').classList.remove('hidden');
            
            // ä¸ºç»ƒä¹ 4æ·»åŠ ç‰¹æ®Šç±»å
            if (index === 3) {
                document.getElementById('question-page').classList.add('practice-4');
            } else {
                document.getElementById('question-page').classList.remove('practice-4');
            }
            
            generateQuestionNew();
        }

        function backToHub() {
            document.getElementById('question-page').classList.add('hidden');
            document.getElementById('practice-hub').classList.remove('hidden');
            updateHubLocks();
        }

        function generateQuestionNew() {
            isAnswered = false;
            document.getElementById('next-practice-btn').disabled = true;

            // æ¸…ç©ºé€‰é¡¹æ ·å¼
            document.querySelectorAll('#options-box .option').forEach(option => {
                option.classList.remove('correct', 'incorrect', 'disabled');
            });

            // æ§åˆ¶å¯è§æ€§
            document.getElementById('question-text').classList.add('hidden');
            document.getElementById('phone-display').classList.add('hidden');
            document.getElementById('audio-question-btn').classList.add('hidden');
            document.getElementById('typing-input').classList.add('hidden');
            document.getElementById('typing-submit').classList.add('hidden');
            document.getElementById('typing-input').value = '';
            document.getElementById('typing-input').classList.remove('correct','incorrect');

            if (currentPractice === 0) {
                // å…œåº•ï¼šé¢˜åº“æœªåˆå§‹åŒ–æ—¶ç«‹å³åˆå§‹åŒ–
                if (!Array.isArray(sessionTargets) || sessionTargets.length < 4) {
                    sessionTargets = shuffleArray([4,5,6,7,8,9,10]).slice(0,4);
                    currentQuestion = 0;
                }
                // æ•°å­— -> æ±‰å­— ï¼ˆé¢˜ç›®ä¸ºé˜¿æ‹‰ä¼¯æ•°å­— 4~10ï¼‰
                const number = sessionTargets[currentQuestion];
                const correctHanzi = hanziData[number - 1].hanzi;
                currentQuestionMeta = { type: 'num_to_hanzi', prompt: String(number), correctAnswer: correctHanzi };

                const wrongOptions = hanziData
                    .filter(item => item.hanzi !== correctHanzi)
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 3)
                    .map(item => item.hanzi);
                const allOptions = shuffleArray([...wrongOptions, correctHanzi]);

                const q = document.getElementById('question-text');
                q.textContent = String(number);
                q.classList.remove('hidden');
                // ç¡®ä¿é€‰é¡¹å®¹å™¨å¯è§
                document.getElementById('options-box').classList.remove('hidden');

                document.querySelectorAll('#options-box .option').forEach((option, index) => {
                    option.textContent = allOptions[index];
                    option.onclick = () => selectOptionNew(option, correctHanzi);
                });
            } else if (currentPractice === 1) {
                // æ±‰å­— -> æ‹¼éŸ³
                const item = sessionTargets[currentQuestion];
                const correctPinyin = item.pinyin;
                currentQuestionMeta = { type: 'hanzi_to_pinyin', prompt: item.hanzi, correctAnswer: correctPinyin };
                const wrongPinyins = shuffleArray(hanziData
                    .filter(h => h.pinyin !== correctPinyin)
                    .map(h => h.pinyin)).slice(0,3);
                const allOptions = shuffleArray([...wrongPinyins, correctPinyin]);

                const q = document.getElementById('question-text');
                q.textContent = item.hanzi;
                q.classList.remove('hidden');

                document.querySelectorAll('#options-box .option').forEach((option, index) => {
                    option.textContent = allOptions[index];
                    option.onclick = () => selectOptionNew(option, correctPinyin);
                });
            } else if (currentPractice === 2) {
                // ç»ƒä¹ 3ï¼šæ‰“å­—è¾“å…¥æ±‰å­—ï¼ˆ0-99æ•°å­—è½¬æ±‰å­—ï¼‰
                const number = sessionTargets[currentQuestion];
                const targetHanzi = numberToHanzi(number);
                currentTypingAnswer = targetHanzi;
                currentQuestionMeta = { type: 'typing', prompt: String(number), correctAnswer: targetHanzi };

                const q = document.getElementById('question-text');
                q.textContent = String(number); // å±å¹•ä¸­å±•ç¤ºé˜¿æ‹‰ä¼¯æ•°å­—
                q.classList.remove('hidden');

                // æ˜¾ç¤ºè¾“å…¥æ¡†ä¸æäº¤æŒ‰é’®ï¼Œéšè—é€‰é¡¹
                document.getElementById('options-box').classList.add('hidden');
                const input = document.getElementById('typing-input');
                const submitBtn = document.getElementById('typing-submit');
                input.classList.remove('hidden');
                submitBtn.classList.remove('hidden');
                setTimeout(()=>input.focus(), 0);

                // å›è½¦é”®ï¼šæœªä½œç­”æ—¶æäº¤ï¼›å·²ä½œç­”æ—¶ç›¸å½“äº Next
                input.onkeydown = (e)=>{
                    if(e.key==='Enter'){
                        e.preventDefault();
                        if (isAnswered) { nextPractice(); }
                        else { submitTyping(); }
                    }
                };
            } else if (currentPractice === 3) {
                // å¬éŸ³ -> é€‰æ±‰å­—
                const item = sessionTargets[currentQuestion];
                currentAudioHanzi = item.hanzi;
                currentQuestionMeta = { type: 'audio_to_hanzi', prompt: currentAudioHanzi, correctAnswer: currentAudioHanzi };
                const wrongHanzi = shuffleArray(hanziData
                    .filter(h => h.hanzi !== currentAudioHanzi)
                    .map(h => h.hanzi)).slice(0,3);
                const allOptions = shuffleArray([...wrongHanzi, currentAudioHanzi]);

                const btn = document.getElementById('audio-question-btn');
                btn.classList.remove('hidden');

                // æ˜¾ç¤ºé€‰é¡¹
                document.getElementById('options-box').classList.remove('hidden');
                document.querySelectorAll('#options-box .option').forEach((option, index) => {
                    option.textContent = allOptions[index];
                    option.onclick = () => selectOptionNew(option, currentAudioHanzi);
                });
            }
        }

        // æ—§ç‰ˆå‡½æ•°ä¿ç•™ï¼ˆä¸å†ä½¿ç”¨ï¼‰
        function generateNumberToHanzi() {
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            const correctNumber = numbers[Math.floor(Math.random() * numbers.length)];
            const correctHanzi = hanziData[correctNumber - 1].hanzi;
            
            // ç”Ÿæˆé”™è¯¯é€‰é¡¹
            const wrongOptions = hanziData
                .filter(item => item.hanzi !== correctHanzi)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3)
                .map(item => item.hanzi);
            
            const allOptions = [...wrongOptions, correctHanzi].sort(() => Math.random() - 0.5);
            
            document.getElementById('question-0').textContent = correctNumber;
            document.querySelectorAll('#options-0 .option').forEach((option, index) => {
                option.textContent = allOptions[index];
                option.onclick = () => selectOption(option, correctHanzi);
            });
        }

        function generateHanziToPinyin() {
            const correctHanzi = hanziData[Math.floor(Math.random() * hanziData.length)];
            const correctPinyin = correctHanzi.pinyin;
            
            // ç”Ÿæˆé”™è¯¯æ‹¼éŸ³é€‰é¡¹
            const wrongPinyins = hanziData
                .filter(item => item.pinyin !== correctPinyin)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3)
                .map(item => item.pinyin);
            
            const allOptions = [...wrongPinyins, correctPinyin].sort(() => Math.random() - 0.5);
            
            document.getElementById('question-1').textContent = correctHanzi.hanzi;
            document.querySelectorAll('#options-1 .option').forEach((option, index) => {
                option.textContent = allOptions[index];
                option.onclick = () => selectOption(option, correctPinyin);
            });
        }

        function generatePhoneNumber() {
            // ç”Ÿæˆéšæœºæ‰‹æœºå·
            const phoneNumber = '138-' + Math.floor(Math.random() * 9000 + 1000) + '-' + Math.floor(Math.random() * 9000 + 1000);
            const correctAnswer = phoneNumber.split('').map(char => {
                if (char === '-') return '-';
                return hanziData[parseInt(char)].hanzi;
            }).join('');
            
            // ç”Ÿæˆé”™è¯¯é€‰é¡¹
            const wrongAnswers = [
                correctAnswer.split('').map((char, index) => {
                    if (char === '-') return '-';
                    if (index === 5) return hanziData[Math.floor(Math.random() * 10)].hanzi;
                    return char;
                }).join(''),
                correctAnswer.split('').map((char, index) => {
                    if (char === '-') return '-';
                    if (index === 7) return hanziData[Math.floor(Math.random() * 10)].hanzi;
                    return char;
                }).join(''),
                correctAnswer.split('').map((char, index) => {
                    if (char === '-') return '-';
                    if (index === 9) return hanziData[Math.floor(Math.random() * 10)].hanzi;
                    return char;
                }).join('')
            ];
            
            const allOptions = [...wrongAnswers, correctAnswer].sort(() => Math.random() - 0.5);
            
            document.getElementById('phone-display').textContent = phoneNumber;
            document.querySelectorAll('#options-2 .option').forEach((option, index) => {
                option.textContent = allOptions[index];
                option.onclick = () => selectOption(option, correctAnswer);
            });
        }

        function generateAudioQuestion() {
            const correctHanzi = hanziData[Math.floor(Math.random() * hanziData.length)];
            
            // ç”Ÿæˆé”™è¯¯é€‰é¡¹
            const wrongOptions = hanziData
                .filter(item => item.hanzi !== correctHanzi.hanzi)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3)
                .map(item => item.hanzi);
            
            const allOptions = [...wrongOptions, correctHanzi.hanzi].sort(() => Math.random() - 0.5);
            
            document.querySelectorAll('#options-3 .option').forEach((option, index) => {
                option.textContent = allOptions[index];
                option.onclick = () => selectOption(option, correctHanzi.hanzi);
            });
        }

        // æ—§ç‰ˆé€‰æ‹©é€»è¾‘å·²åºŸå¼ƒ

        function selectOptionNew(element, correctAnswer) {
            if (isAnswered) return;
            isAnswered = true;
            const selectedAnswer = element.textContent;
            const isCorrect = selectedAnswer === correctAnswer;

            document.querySelectorAll('#options-box .option').forEach(opt => {
                opt.classList.add('disabled');
                if (opt.textContent === correctAnswer) {
                    opt.classList.add('correct');
                } else if (opt === element && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            if (isCorrect) practiceScores[currentPractice]++;
            practiceQuestions[currentPractice]++;
            if (currentQuestionMeta) {
                practiceDetails[currentPractice].push({
                    prompt: currentQuestionMeta.prompt,
                    yourAnswer: selectedAnswer,
                    correctAnswer: currentQuestionMeta.correctAnswer,
                    isCorrect
                });
            }
            updateProgress();
            document.getElementById('next-practice-btn').disabled = false;
        }

        function updateProgress() {
            // å®Œæˆå½“å‰ç»ƒä¹ ï¼šå½“ç­”æ»¡4é¢˜æ—¶æ ‡è®°å®Œæˆå¹¶è§£é”ä¸‹ä¸€é¡¹
            if (practiceQuestions[currentPractice] >= 4) {
                practiceCompleted[currentPractice] = true;
                updateHubLocks();
            }
        }

        function nextPractice() {
            currentQuestion++;
            if (currentQuestion >= 4) {
                // å®Œæˆå½“å‰ç»ƒä¹ ï¼šè¿”å›ç»ƒä¹ ä¸­å¿ƒï¼›è‹¥å››é¡¹çš†å®Œæˆï¼Œå±•ç¤ºæ€»ç»“
                const allDone = practiceCompleted.every(v => v) || currentPractice === 3;
                backToHub();
                if (allDone && practiceCompleted[0] && practiceCompleted[1] && practiceCompleted[2]) {
                    showSummary();
                }
                return;
            }
            generateQuestionNew();
        }

        function playAudio() {
            // è¿™é‡Œå¯ä»¥æ·»åŠ çœŸå®çš„éŸ³é¢‘æ’­æ”¾åŠŸèƒ½
            // ç›®å‰åªæ˜¯æ¨¡æ‹Ÿ
            alert('æ’­æ”¾éŸ³é¢‘: ä¹ (jiÇ”)');
        }

        // å•é¢˜é¡µé¢ï¼šå¬éŸ³é¢˜æ’­æ”¾
        function playAudioQuestion() {
            if (!currentAudioHanzi) return;
            const src = getAudioSrcForHanzi(currentAudioHanzi);
            const temp = new Audio(src);
            temp.play().catch(() => speakFallback(currentAudioHanzi));
        }

        // æäº¤æ‰“å­—ç­”æ¡ˆ
        function submitTyping() {
            if (isAnswered) return;
            const input = document.getElementById('typing-input');
            const value = (input.value || '').trim();
            const isCorrect = value === currentTypingAnswer;
            isAnswered = true;
            if (isCorrect) {
                input.classList.add('correct');
                practiceScores[currentPractice]++;
            } else {
                input.classList.add('incorrect');
            }
            practiceQuestions[currentPractice]++;
            if (currentQuestionMeta) {
                practiceDetails[currentPractice].push({
                    prompt: currentQuestionMeta.prompt,
                    yourAnswer: value,
                    correctAnswer: currentQuestionMeta.correctAnswer,
                    isCorrect
                });
            }
            updateProgress();
            document.getElementById('next-practice-btn').disabled = false;
        }

        // å·¥å…·å‡½æ•°
        function shuffleArray(arr) {
            return arr
                .map(v => ({ v, r: Math.random() }))
                .sort((a, b) => a.r - b.r)
                .map(({ v }) => v);
        }

        function genPhone() {
            const rand4 = () => String(Math.floor(Math.random() * 9000 + 1000));
            return '1' + String(Math.floor(Math.random() * 8) + 2) + String(Math.floor(Math.random() * 8) + 1) + '-' + rand4() + '-' + rand4();
        }

        function phoneToHanzi(phone) {
            return phone.split('').map(ch => ch === '-' ? '-' : hanziData[parseInt(ch)].hanzi).join('');
        }

        function genPhoneWrongOptions(correct) {
            // ç”Ÿæˆ3ä¸ªå¹²æ‰°é¡¹ï¼šéšæœºæ›¿æ¢æŸäº›ä½ç½®çš„æ•°å­—
            const idxs = [5,7,9];
            const make = i => correct.split('').map((ch, idx) => {
                if (ch === '-') return '-';
                if (idx === idxs[i]) {
                    return hanziData[Math.floor(Math.random() * 10)].hanzi;
                }
                return ch;
            }).join('');
            return [make(0), make(1), make(2)];
        }

        // æ•°å­—è½¬æ±‰å­—ï¼ˆ0-99ï¼‰
        function numberToHanzi(num) {
            if (num === 0) return 'é›¶';
            if (num <= 10) return hanziData[num - 1].hanzi;
            
            const tens = Math.floor(num / 10);
            const ones = num % 10;
            
            if (tens === 1) {
                return ones === 0 ? 'å' : 'å' + hanziData[ones - 1].hanzi;
            } else {
                const tensHanzi = hanziData[tens - 1].hanzi;
                return ones === 0 ? tensHanzi + 'å' : tensHanzi + 'å' + hanziData[ones - 1].hanzi;
            }
        }

        // ===== å¤ä¹ æ¨¡å—: éŸ³é¢‘æ’­æ”¾ =====
        function getAudioSrcForHanzi(hanzi) {
            // å°†æ±‰å­—æ˜ å°„åˆ°éŸ³é¢‘æ–‡ä»¶å
            const map = {
                'ä¸€': 'yi',
                'äºŒ': 'er',
                'ä¸‰': 'san',
                'å››': 'si',
                'äº”': 'wu',
                'å…­': 'liu',
                'ä¸ƒ': 'qi',
                'å…«': 'ba',
                'ä¹': 'jiu',
                'å': 'shi'
            };
            const key = map[hanzi];
            return key ? `audio/${key}.mp3` : '';
        }

        function speakFallback(text) {
            console.log('=== è¯­éŸ³åˆæˆå¼€å§‹ ===');
            console.log('è¦æ’­æ”¾çš„æ–‡æœ¬:', text);
            console.log('æµè§ˆå™¨æ”¯æŒè¯­éŸ³åˆæˆ:', 'speechSynthesis' in window);
            
            try {
                // åœæ­¢ä»»ä½•æ­£åœ¨æ’­æ”¾çš„è¯­éŸ³
                window.speechSynthesis.cancel();
                
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = 'zh-CN';
                utter.rate = 0.8;
                utter.pitch = 1;
                utter.volume = 1;
                
                console.log('è¯­éŸ³åˆæˆå¯¹è±¡:', utter);
                console.log('è¯­éŸ³åˆæˆè¯­è¨€:', utter.lang);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                utter.onstart = () => console.log('è¯­éŸ³åˆæˆå¼€å§‹æ’­æ”¾');
                utter.onend = () => console.log('è¯­éŸ³åˆæˆæ’­æ”¾ç»“æŸ');
                utter.onerror = (e) => console.error('è¯­éŸ³åˆæˆé”™è¯¯:', e);
                
                window.speechSynthesis.speak(utter);
                console.log('è¯­éŸ³åˆæˆå·²è°ƒç”¨');
                
            } catch (e) {
                console.error('è¯­éŸ³åˆæˆå¼‚å¸¸:', e);
            }
        }

        function playReviewAudio(event) {
            if (event) event.stopPropagation();
            
            console.log('=== å¼€å§‹æ’­æ”¾å¤ä¹ éŸ³é¢‘ ===');
            const data = hanziData[currentCardIndex];
            console.log('å½“å‰æ±‰å­—æ•°æ®:', data);
            console.log('å½“å‰å¡ç‰‡ç´¢å¼•:', currentCardIndex);
            
            const audioEl = document.getElementById('review-audio');
            console.log('éŸ³é¢‘å…ƒç´ :', audioEl);
            
            if (!audioEl) {
                console.error('æ‰¾ä¸åˆ°éŸ³é¢‘å…ƒç´ ');
                return;
            }

            const audioSrc = getAudioSrcForHanzi(data.hanzi);
            console.log('éŸ³é¢‘æºè·¯å¾„:', audioSrc);

            // è®¾ç½®é”™è¯¯å¤„ç†
            const onError = (e) => {
                console.error('éŸ³é¢‘æ–‡ä»¶åŠ è½½å¤±è´¥:', audioSrc, e);
                audioEl.removeEventListener('error', onError);
                // å¦‚æœéŸ³é¢‘æ–‡ä»¶å¤±è´¥ï¼Œå°è¯•è¯­éŸ³åˆæˆ
                speakFallback(data.hanzi);
            };
            
            const onLoadStart = () => {
                console.log('å¼€å§‹åŠ è½½éŸ³é¢‘æ–‡ä»¶:', audioSrc);
            };
            
            const onCanPlay = () => {
                console.log('éŸ³é¢‘æ–‡ä»¶å¯ä»¥æ’­æ”¾');
            };

            audioEl.removeEventListener('error', onError);
            audioEl.removeEventListener('loadstart', onLoadStart);
            audioEl.removeEventListener('canplay', onCanPlay);
            
            audioEl.addEventListener('error', onError, { once: true });
            audioEl.addEventListener('loadstart', onLoadStart, { once: true });
            audioEl.addEventListener('canplay', onCanPlay, { once: true });

            audioEl.src = audioSrc;
            audioEl.load();
            
            audioEl.play().then(() => {
                console.log('éŸ³é¢‘æ’­æ”¾æˆåŠŸ');
            }).catch((error) => {
                console.error('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', error);
                // å¦‚æœæ’­æ”¾å¤±è´¥ï¼Œå°è¯•è¯­éŸ³åˆæˆ
                speakFallback(data.hanzi);
            });
        }

        function showSummary() {
            document.getElementById('practice-page').classList.add('hidden');
            document.getElementById('summary-page').classList.remove('hidden');
            
            const totalScore = practiceScores.reduce((a, b) => a + b, 0);
            const totalQuestions = practiceQuestions.reduce((a, b) => a + b, 0);
            const percentage = totalQuestions > 0 ? Math.round((totalScore / totalQuestions) * 100) : 0;
            
            document.getElementById('final-score').textContent = `${percentage}%`;
            document.getElementById('score-circle').style.setProperty('--score-angle', `${percentage * 3.6}deg`);
            
            let summaryText = `Congratulations! You have completed all the exercises!\n\n`;
            summaryText += `Total Score: ${totalScore} / ${totalQuestions}\n`;
            summaryText += `Accuracy: ${percentage}%`;
            
            if (percentage >= 90) {
                summaryText += `\n\nğŸ‰ Excellent! Outstanding performance!`;
            } else if (percentage >= 80) {
                summaryText += `\n\nğŸ‘ Great job! Keep it up!`;
            } else if (percentage >= 70) {
                summaryText += `\n\nğŸ’ª Good work! Practice more to improve!`;
            } else {
                summaryText += `\n\ğŸ¤© Keep practicing, you can do it!`;
            }
            
            document.getElementById('summary-text').textContent = summaryText;
        }

        function showDetail() {
            document.getElementById('summary-page').classList.add('hidden');
            document.getElementById('detail-page').classList.remove('hidden');
            renderDetail();
        }

        function showSummaryFromDetail() {
            document.getElementById('detail-page').classList.add('hidden');
            document.getElementById('summary-page').classList.remove('hidden');
        }

        function renderDetail() {
            const container = document.getElementById('detail-content');
            const practiceTitles = [
                'Practice 1 Â· Select Hanzi',
                'Practice 2 Â· Choose Pinyin',
                'Practice 3 Â· Type Hanzi',
                'Practice 4 Â· Listen & Select'
            ];
            const circledNumbers = ['âŠ','â‹','âŒ','â','â','â','â','â‘','â’','â“'];
            let html = '';
            for (let i = 0; i < 4; i++) {
                const list = practiceDetails[i] || [];
                if (!list.length) continue;
                html += `
                    <div class="detail-section">
                        <div class="detail-section-title">${practiceTitles[i]}</div>
                        <table class="detail-table">
                            <thead>
                                <tr>
                                    <th>No.</th>
                                    <th>Correct Answer</th>
                                    <th>Your Answer</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${list.map((row, idx) => `
                                    <tr>
                                        <td>${circledNumbers[idx] || (idx + 1)}</td>
                                        <td class="latin">${row.correctAnswer}</td>
                                        <td class="latin ${row.isCorrect ? 'tag-correct' : 'tag-wrong'}">${row.yourAnswer ?? ''}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }
            if (!html) {
                html = '<div style="text-align:center;color:#2d2d42;">æš‚æ— è¯¦æƒ…ï¼Œè¯·å…ˆå®Œæˆç»ƒä¹ ã€‚</div>';
            }
            container.innerHTML = html;
        }

        // å…¨å±€å›è½¦ = Nextï¼ˆå½“é¢˜ç›®é¡µæ˜¾ç¤ºä¸” Next å¯ç”¨æ—¶ï¼‰
        document.addEventListener('keydown', function(e){
            if (e.key === 'Enter') {
                const qp = document.getElementById('question-page');
                const nextBtn = document.getElementById('next-practice-btn');
                if (qp && !qp.classList.contains('hidden') && nextBtn && !nextBtn.disabled) {
                    e.preventDefault();
                    nextPractice();
                }
            }
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            showMain();
        });
    </script>
</body>
</html>